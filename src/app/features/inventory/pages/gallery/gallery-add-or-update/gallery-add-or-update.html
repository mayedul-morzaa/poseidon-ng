
<p-dialog 
[(visible)]="visible" 
[style]="{ width: '600px' }" 
header="Add New Gallery" 
[modal]="true"
(onHide)="closeDialog()"
>
  <ng-template #content>
    <form [formGroup]="form" (ngSubmit)="submit()" class="flex flex-col gap-6">

      <!-- ðŸ”¹ Title Row -->
      <div>
        <label for="title" class="block font-bold mb-2">Title</label>
        <input type="text" pInputText id="title" formControlName="title" class="w-full" autofocus />
        @if (form.controls['title'].invalid && form.controls['title'].touched) {
          <small class="text-red-500">Title is required.</small>
        }
      </div>

      <!-- ðŸ”¹ Gallery Level Row -->
      <div>
        <label for="galleryLevel" class="block font-bold mb-2">Gallery Level</label>
        <p-select
          inputId="galleryLevel"
          formControlName="galleryLevel"
          [options]="galleryLevelOptions"
          optionLabel="name"
          optionValue="id"
          placeholder="Select Gallery Level"
          fluid
          filter
        />
        @if (form.controls['galleryLevel'].invalid && form.controls['galleryLevel'].touched) {
          <small class="text-red-500">Gallery Level is required.</small>
        }
      </div>

      <!-- ðŸ”¹ ParentGalleryId -->
      <div>
          <label for="parentGalleryId" class="block font-bold mb-2">Parent Gallery</label>

          @if (!isBaseLevel) {
            <p-select
              inputId="parentGalleryId"
              formControlName="parentGalleryId"
              [options]="filteredParentOptions"
              optionLabel="title"
              optionValue="id"
              placeholder="Select Parent Gallery"
              fluid
              filter
            />
          } @else {
            <input
              type="text"
              pInputText
              formControlName="parentGalleryId"
              class="w-full"
              [disabled]="true"
              placeholder="Base galleries have no parent"
            />
          }
      </div>

        <div>
          <label class="block font-bold mb-2">Gallery Items</label>
          <p-fileUpload
            name="galleryItems"
            [customUpload]="true"
            [auto]="true"
            multiple
            (uploadHandler)="handleGalleryItemUpload($event)"
            accept="image/*"
            chooseLabel="Select Images"
            dropZoneLabel="Drag & drop images here"
            class="w-full border-round surface-section shadow-1"
          />
      </div>
    </form>
  </ng-template>

  <ng-template #footer>
    <p-button label="Cancel" icon="pi pi-times" text (click)="closeDialog()" />
    <p-button label="Save" icon="pi pi-check" (onClick)="submit()" [disabled]="form.invalid" />
  </ng-template>
</p-dialog>

