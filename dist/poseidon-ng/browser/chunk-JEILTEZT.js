import{a as X}from"./chunk-SDCOHH4B.js";import{i as Y,j}from"./chunk-2OPB2DQR.js";import{a as O}from"./chunk-KLVIWWTK.js";import{s as F}from"./chunk-QIAVZCJE.js";import{Tb as _,W as E,Xa as B,rb as H,sc as V,tc as W,ub as R,uc as z,xc as r}from"./chunk-YSO2AELB.js";var I=class T{get styleClass(){return this.class()}layoutService=E(O);isDarkTheme=W(()=>this.layoutService.isDarkTheme());class=r("");labels=r([]);datasets=r([]);bgColors=r();borderColors=r();show=r(12);tooltipPrefix=r("$");option=r("month");stepSize=r(2e3);dataReduction=r(!0);data;plugins;chartData;chartOptions;constructor(){z(()=>{this.option(),this.isDarkTheme(),this.drawChart(),V(()=>this.tooltipPrefix())})}drawChart(){setTimeout(()=>{this.chartData=this.setChartData(this.option()),this.chartOptions=this.setChartOptions(this.tooltipPrefix()),this.plugins=this.setChartPlugins()},100)}setChartData(d){let o=this.dataReduction()?X(this.datasets(),d,this.show()):this.datasets();if(o.length<=0)return this.data=[],{datasets:null};let t=this.isDarkTheme()??!1,l=getComputedStyle(document.documentElement),g=l.getPropertyValue("--p-surface-0"),f=l.getPropertyValue("--p-surface-950"),c=o[0].y.length,n=Array(c).fill(null).map((i,a)=>({label:this.labels()[a]??"dataset"+a,data:[],fill:!0,borderColor:this.borderColors()?.[a]??(t?"#FAFAFA":"#030616"),tension:.3,borderWidth:1.2,pointBorderColor:"rgba(0, 0, 0, 0)",pointBackgroundColor:"rgba(0, 0, 0, 0)",pointHoverBackgroundColor:this.borderColors()?.[a]??(t?g:f),pointHoverBorderColor:t?f:g,pointBorderWidth:12,hideInLegendAndTooltip:!1,pointStyle:"circle",pointRadius:4,backgroundColor:e=>{let p=[t?"rgba(255, 255, 255, 0.12)":"rgba(3, 6, 22, 0.06)",t?"rgba(255, 255, 255, 0)":"rgba(3, 6, 22, 0)"],m=this.bgColors()?.[a]!==void 0?this.bgColors()[a]:p;if(!e.chart.chartArea)return;let{ctx:C,chartArea:{top:D,bottom:x}}=e.chart,v=C.createLinearGradient(0,D,0,x),M=1/(m.length-1);for(let u=0;u<m.length;u++)v.addColorStop(0+u*M,m[u]);return v}}));return o.forEach(({x:i,y:a})=>{Array(c).fill(null).forEach((e,p)=>{n[p].data.push({x:i,y:a[p]})})}),this.data=n,{datasets:n}}setChartPlugins(){return[{id:"hoverLine",beforeDatasetsDraw:o=>{let{ctx:t,tooltip:l,chartArea:{bottom:g},scales:{x:f}}=o;if(l&&l._active.length>0){let c=f.getPixelForValue(l.dataPoints[0].raw.x);t.save(),t.beginPath(),t.lineWidth=1.2;let i=getComputedStyle(document.documentElement).getPropertyValue("--p-surface-500");t.strokeStyle=i,t.setLineDash([4,4]),t.moveTo(c,0),t.lineTo(c,g+8),t.stroke(),t.closePath(),t.restore()}}}]}setChartOptions(d){let o=this.isDarkTheme()??!1,t=getComputedStyle(document.documentElement),l=t.getPropertyValue("--p-surface-400"),g=t.getPropertyValue("--p-surface-200"),f=new Date(this.data[this.data.length-1].x),c=new Date(this.data[0].x);return{interaction:{intersect:!1,mode:"index"},responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{tooltip:{enabled:!1,position:"nearest",external:function(n){let{chart:i,tooltip:a}=n,e=i.canvas.parentNode.querySelector("div.chartjs-tooltip");if(e||(e=document.createElement("div"),e.classList.add("chartjs-tooltip","dark:bg-surface-950","bg-surface-0","rounded-[8px]","overflow-hidden","opacity-100","border","border-surface","absolute","transition-all","duration-[0.05s]","pointer-events-none","shadow-[0px_16px_32px_-12px_rgba(88,92,95,0.10)]"),i.canvas.parentNode.appendChild(e)),a.opacity===0){e.style.opacity=0;return}let p=a.dataPoints.map(s=>s.element.x),m=p.reduce((s,h)=>s+h,0)/p.length,C=a.dataPoints.map(s=>s.element.y),D=C.reduce((s,h)=>s+h,0)/C.length;if(a.body){e.innerHTML="";let s=document.createElement("div");s.classList.add("bg-surface-100","dark:bg-surface-900","px-3","py-2.5","border-b","border-surface","text-left","label-xsmall"),s.appendChild(document.createTextNode(a.title[0])),e.appendChild(s);let h=document.createElement("div");h.classList.add("flex","flex-col","gap-2","px-3","py-2","min-w-50"),a.dataPoints.forEach(w=>{let b=document.createElement("div");b.classList.add("flex","items-center","gap-2","w-full");let S=document.createElement("div");S.classList.add("w-2.5","h-2.5","rounded-full"),S.style.backgroundColor=w.dataset.borderColor,b.appendChild(S);let L=document.createElement("span");L.appendChild(document.createTextNode(w.dataset.label)),L.classList.add("text-base","text-surface-950","dark:text-surface-0","flex-1","text-left","capitalize"),b.appendChild(L);let N=document.createElement("span");N.appendChild(document.createTextNode(d+w.formattedValue)),N.classList.add("text-base","text-surface-950","dark:text-surface-0","text-right"),b.appendChild(N),h.appendChild(b)}),e.appendChild(h)}let{offsetLeft:x,offsetTop:v}=i.canvas;e.style.opacity=1,e.style.font=a.options.bodyFont.string,e.style.padding="0px";let M=i.width,u=e.offsetWidth,A=i.height,P=e.offsetHeight,k=x+m+20,y=v+D-P/2;k+u>M&&(k=x+m-u-20),y<0?y=0:y+P>A&&(y=A-P),e.style.left=k+"px",e.style.top=y+"px"}},legend:{display:!1},title:{display:!1}},scales:{x:{type:"time",time:{unit:this.option(),tooltipFormat:"MM/dd/yyyy HH:mm"},min:c,max:f,offset:!1,grid:{display:!0,lineWidth:1.2,color:"rgba(255,255,255,0)"},ticks:{color:o?"rgba(255, 255, 255, 0.40)":l,autoSkip:!1,maxRotation:0,source:"auto"},border:{display:!1}},y:{beginAtZero:!0,display:!0,min:0,border:{display:!1},ticks:{color:o?"rgba(255, 255, 255, 0.40)":l,autoSkip:!1,maxRotation:0,source:"auto",stepSize:this.stepSize(),callback:function(n){return n>1e3?n/1e3+"K":n}},grid:{display:!0,lineWidth:1,color:o?"rgba(255, 255, 255, 0.08)":g}}}}}static \u0275fac=function(o){return new(o||T)};static \u0275cmp=B({type:T,selectors:[["multi-line-chart"]],hostAttrs:[1,"max-h-80!","min-h-72","min-w-[640px]","w-full","overflow-auto","h-full","cursor-pointer"],hostVars:2,hostBindings:function(o,t){o&2&&_(t.styleClass)},inputs:{class:[1,"class"],labels:[1,"labels"],datasets:[1,"datasets"],bgColors:[1,"bgColors"],borderColors:[1,"borderColors"],show:[1,"show"],tooltipPrefix:[1,"tooltipPrefix"],option:[1,"option"],stepSize:[1,"stepSize"],dataReduction:[1,"dataReduction"]},decls:1,vars:3,consts:[["type","line",3,"data","plugins","options"]],template:function(o,t){o&1&&R(0,"p-chart",0),o&2&&H("data",t.chartData)("plugins",t.plugins)("options",t.chartOptions)},dependencies:[F,j,Y],styles:["[_nghost-%COMP%]     p-chart{height:100%}[_nghost-%COMP%]     p-chart canvas{height:100%}"]})};export{I as a};
