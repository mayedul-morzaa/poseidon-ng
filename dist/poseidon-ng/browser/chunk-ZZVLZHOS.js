import{b as F}from"./chunk-SDCOHH4B.js";import{i as I,j as z}from"./chunk-2OPB2DQR.js";import{a as H}from"./chunk-KLVIWWTK.js";import{s as O}from"./chunk-QIAVZCJE.js";import{Tb as E,W as S,Xa as L,rb as T,tc as B,ub as V,uc as x,xc as o}from"./chunk-YSO2AELB.js";var _=class D{get styleClass(){return this.class()}layoutService=S(H);class=o("");labels=o([""]);dataset=o([]);show=o(12);tooltipPrefix=o("$");option=o("month");bgColors=o();stepSize=o(2e3);label=o("Label");isDarkTheme=B(()=>this.layoutService.isDarkTheme());data;plugins=[];chartData;chartOptions;chartColors;constructor(){x(()=>{this.isDarkTheme(),this.drawChart()}),x(()=>{this.dataset(),this.drawChart()})}ngOnInit(){this.drawChart()}drawChart(){setTimeout(()=>{this.setChartColors(),this.chartData=this.setChartData(this.option()),this.chartOptions=this.setChartOptions(this.tooltipPrefix())},100)}setChartColors(){let e=getComputedStyle(document.documentElement);this.chartColors={surface100:e.getPropertyValue("--p-surface-100"),surface200:e.getPropertyValue("--p-surface-200"),surface400:e.getPropertyValue("--p-surface-400"),surface500:e.getPropertyValue("--p-surface-500"),surface700:e.getPropertyValue("--p-surface-700"),surface900:e.getPropertyValue("--p-surface-900")}}setChartData(e){let t=F(this.dataset(),e,this.show());if(t.length<=0){this.data=[];return}let s=getComputedStyle(document.documentElement),h=s.getPropertyValue("--p-primary-color"),u=s.getPropertyValue("--p-primary-600");if(t[t.length-1].x===void 0){let m=t[t.length-2].x,r=this.getIntervalFromOption(e);t[t.length-1].x=this.addInterval(m,r)}return this.data=t,{datasets:[{label:this.label()??"dataset",data:t,fill:!0,backgroundColor:h,hoverBackgroundColor:u,hideInLegendAndTooltip:!1,barThickness:24,borderRadius:{topLeft:4,topRight:4,bottomLeft:0,bottomRight:0}}]}}getIntervalFromOption(e){switch(e){case"week":return{weeks:1};case"month":return{months:1};case"quarter":return{months:3};case"year":return{years:1};default:return{days:1}}}addInterval(e,t){return new Date(e.getFullYear()+(t.years||0),e.getMonth()+(t.months||0),e.getDate()+(t.days||0)+(t.weeks?t.weeks*7:0))}setChartOptions(e){let t=getComputedStyle(document.documentElement),s=t.getPropertyValue("--p-surface-200"),h=t.getPropertyValue("--p-surface-400"),u=new Date(this.data[this.data.length-1].x),m=new Date(this.data[0].x);return{interaction:{intersect:!1,mode:"index"},responsive:!0,maintainAspectRatio:!1,layout:{padding:0},plugins:{tooltip:{enabled:!1,position:"nearest",external:function(r){let{chart:l,tooltip:i}=r,a=l.canvas.parentNode.querySelector("div.chartjs-tooltip");if(a||(a=document.createElement("div"),a.classList.add("chartjs-tooltip","dark:bg-surface-950","bg-surface-0","rounded-[8px]","overflow-hidden","opacity-100","border","border-surface","absolute","transition-all","duration-[0.05s]","pointer-events-none","shadow-[0px_16px_32px_-12px_rgba(88,92,95,0.10)]"),l.canvas.parentNode.appendChild(a)),i.opacity===0){a.style.opacity=0;return}let v=i.dataPoints.map(n=>n.element.x),k=v.reduce((n,c)=>n+c,0)/v.length,R=i.dataPoints[0].element.y;if(i.body){a.innerHTML="";let n=document.createElement("div");n.classList.add("bg-surface-100","dark:bg-surface-900","px-3","py-2.5","border-b","border-surface","text-left","label-xsmall"),n.appendChild(document.createTextNode(i.title[0])),a.appendChild(n);let c=document.createElement("div");c.classList.add("flex","flex-col","gap-2","px-3","py-2","min-w-50"),i.dataPoints.reverse().forEach(f=>{let p=document.createElement("div");p.classList.add("flex","items-center","gap-2","w-full");let y=document.createElement("div");y.classList.add("w-2.5","h-2.5","rounded-full"),y.style.backgroundColor=f.dataset.backgroundColor,p.appendChild(y);let b=document.createElement("span");b.appendChild(document.createTextNode(f.dataset.label)),b.classList.add("paragraph-xsmall","text-base","text-surface-950","dark:text-surface-0","flex-1","text-left","capitalize"),p.appendChild(b);let C=document.createElement("span");C.appendChild(document.createTextNode(e+f.formattedValue)),C.classList.add("paragraph-xsmall","text-base","text-surface-950","dark:text-surface-0","text-right"),p.appendChild(C),c.appendChild(p)}),a.appendChild(c)}let{offsetLeft:w}=l.canvas;a.style.opacity=1,a.style.font=i.options.bodyFont.string,a.style.padding=0;let A=l.width,M=a.offsetWidth,P=l.height,N=a.offsetHeight,g=w+k+20,d=R;g+M>A&&(g=w+k-M-20),d<0?d=0:d+N>P&&(d=P-N),a.style.left=g+"px",a.style.top=d+"px"}},legend:{display:!1},title:{display:!1}},scales:{x:{stacked:!0,type:"time",time:{unit:this.option(),tooltipFormat:"MM/dd/yyyy HH:mm",displayFormats:{week:"MMM d, yyyy",month:"MMM yyyy",quarter:"QQQ yyyy",year:"yyyy"}},min:m,max:u,offset:!0,grid:{display:!1},ticks:{color:this.isDarkTheme()?"rgba(255, 255, 255, 0.40)":h,autoSkip:!0,maxRotation:0,source:"data"},border:{display:!1}},y:{beginAtZero:!0,display:!0,stacked:!0,min:0,grid:{display:!0,color:this.isDarkTheme()?"rgba(255, 255, 255, 0.08)":s,tickBorderDash:[2,2]},border:{dash:[8,4],dashOffset:6,display:!1},ticks:{maxTicksLimit:6,color:this.isDarkTheme()?"rgba(255, 255, 255, 0.40)":h,stepSize:this.stepSize(),callback:function(r){return r>1e3?r/1e3+"K":r}}}}}}static \u0275fac=function(t){return new(t||D)};static \u0275cmp=L({type:D,selectors:[["bar-chart"]],hostAttrs:[1,"h-full","w-full","cursor-pointer","min-w-[640px]","max-h-80"],hostVars:2,hostBindings:function(t,s){t&2&&E(s.styleClass)},inputs:{class:[1,"class"],labels:[1,"labels"],dataset:[1,"dataset"],show:[1,"show"],tooltipPrefix:[1,"tooltipPrefix"],option:[1,"option"],bgColors:[1,"bgColors"],stepSize:[1,"stepSize"],label:[1,"label"]},decls:1,vars:3,consts:[["type","bar",2,"height","100%","display","block",3,"data","plugins","options"]],template:function(t,s){t&1&&V(0,"p-chart",0),t&2&&T("data",s.chartData)("plugins",s.plugins)("options",s.chartOptions)},dependencies:[O,z,I],styles:["[_nghost-%COMP%]     p-chart{height:100%}[_nghost-%COMP%]     p-chart canvas{height:100%}"]})};export{_ as a};
